@{
    ViewData["Title"] = "Generate Period";
    var user = ViewBag.DefaultCreatedBy as string ?? "system";
}
<div class="container py-5">
    <div class="row justify-content-center">
        <div class="col-md-7">
            <div class="card shadow rounded-4">
                <div class="card-header bg-white border-bottom">
                    <h4 class="mb-0 text-dark fw-bold">âž• Generate Period</h4>
                </div>
                <div class="card-body">
                    <form asp-action="Create" method="post">
                        @Html.AntiForgeryToken()
                        <div asp-validation-summary="All" class="alert alert-danger rounded-4"></div>

                        <div class="mb-3">
                            <label class="form-label fw-semibold">Year</label>
                            <input name="year" type="number" min="1900" max="3000" class="form-control"
                                placeholder="e.g., 2025" required />
                        </div>

                        <div class="mb-3">
                            <label class="form-label fw-semibold">Type</label>
                            <div class="form-check">
                                <input class="form-check-input" type="radio" name="periodType" id="typeYear"
                                    value="year" checked>
                                <label class="form-check-label" for="typeYear">Year only</label>
                            </div>
                            <div class="form-check">
                                <input class="form-check-input" type="radio" name="periodType" id="typeMonth"
                                    value="month">
                                <label class="form-check-label" for="typeMonth">Year + Month</label>
                            </div>
                            <div class="form-check">
                                <input class="form-check-input" type="radio" name="periodType" id="typeQuarter"
                                    value="quarter">
                                <label class="form-check-label" for="typeQuarter">Year + Quarter</label>
                            </div>
                        </div>

                        <div id="monthPicker" class="mb-3 d-none">
                            <label class="form-label fw-semibold">Month</label>
                            <select name="monthNum" class="form-select">
                                <option value="">-- Select Month --</option>
                                <option value="1">1 - Jan</option>
                                <option value="2">2 - Feb</option>
                                <option value="3">3 - Mar</option>
                                <option value="4">4 - Apr</option>
                                <option value="5">5 - May</option>
                                <option value="6">6 - Jun</option>
                                <option value="7">7 - Jul</option>
                                <option value="8">8 - Aug</option>
                                <option value="9">9 - Sep</option>
                                <option value="10">10 - Oct</option>
                                <option value="11">11 - Nov</option>
                                <option value="12">12 - Dec</option>
                            </select>
                        </div>

                        <div id="quarterPicker" class="mb-3 d-none">
                            <label class="form-label fw-semibold">Quarter</label>
                            <select name="quarterNum" class="form-select">
                                <option value="">-- Select Quarter --</option>
                                <option value="1">Q1</option>
                                <option value="2">Q2</option>
                                <option value="3">Q3</option>
                                <option value="4">Q4</option>
                            </select>
                        </div>

                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label class="form-label fw-semibold">Created By</label>
                                <input name="createdBy" class="form-control" maxlength="150" value="@user" required />
                            </div>
                            <div class="col-md-6 mb-3">
                                <label class="form-label fw-semibold">Last Changed By</label>
                                <input name="lastChangedBy" class="form-control" maxlength="150" value="@user"
                                    required />
                            </div>
                        </div>

                        <div class="d-flex gap-2">
                            <button type="submit" class="btn btn-primary btn-lg">ðŸ’¾ Save</button>
                            <a class="btn btn-outline-secondary btn-lg" href="@Url.Action("Index")">Cancel</a>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>

@section Scripts {
    @{
        await Html.RenderPartialAsync("_ValidationScriptsPartial");
    }
    <script>
        (function () {
            const rYear = document.getElementById('typeYear');
            const rMonth = document.getElementById('typeMonth');
            const rQuarter = document.getElementById('typeQuarter');
            const monthPicker = document.getElementById('monthPicker');
            const quarterPicker = document.getElementById('quarterPicker');

            function updatePickers() {
                monthPicker.classList.toggle('d-none', !rMonth.checked);
                quarterPicker.classList.toggle('d-none', !rQuarter.checked);
            }

            [rYear, rMonth, rQuarter].forEach(r => r.addEventListener('change', updatePickers));
            updatePickers(); // init
        })();
    </script>
}